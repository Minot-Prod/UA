{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Parlios MVP Assembleur — Étape 13 (security_backend)",
  "type": "object",
  "required": [
    "security_backend"
  ],
  "properties": {
    "security_backend": {
      "type": "object",
      "required": [
        "cors",
        "rate_limit",
        "audit",
        "headers"
      ],
      "properties": {
        "cors": {
          "type": "object",
          "required": [
            "enabled",
            "allow_origin",
            "allow_methods",
            "allow_headers",
            "allow_credentials",
            "max_age_seconds"
          ],
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "allow_origin": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "allow_methods": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "allow_headers": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "allow_credentials": {
              "type": "boolean"
            },
            "max_age_seconds": {
              "type": "integer",
              "minimum": 0
            }
          }
        },
        "rate_limit": {
          "type": "object",
          "required": [
            "enabled",
            "window_seconds",
            "max_requests",
            "key_strategy"
          ],
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "window_seconds": {
              "type": "integer",
              "minimum": 1
            },
            "max_requests": {
              "type": "integer",
              "minimum": 1
            },
            "key_strategy": {
              "type": "string"
            }
          }
        },
        "audit": {
          "type": "object",
          "required": [
            "enabled",
            "events",
            "sink"
          ],
          "properties": {
            "enabled": {
              "type": "boolean"
            },
            "events": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "sink": {
              "type": "string"
            },
            "file_path": {
              "type": "string"
            }
          }
        },
        "headers": {
          "type": "object",
          "properties": {
            "strict_transport_security": {
              "type": "string"
            },
            "content_security_policy": {
              "type": "string"
            },
            "x_content_type_options": {
              "type": "string"
            },
            "x_frame_options": {
              "type": "string"
            },
            "referrer_policy": {
              "type": "string"
            },
            "permissions_policy": {
              "type": "string"
            }
          }
        }
      }
    }
  }
}